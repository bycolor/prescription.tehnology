<!DOCTYPE HTML>
<html>
	<head>
		<title>Slide Menu</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
		<link rel="stylesheet" type="text/css" href="css/reset.css" media="screen"/>
		<link rel="stylesheet" type="text/css" href="css/responsive.gs.24col.css" media="screen"/>
		<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/styles.css" media="screen"/>
		<link rel="stylesheet" type="text/css" href="css/slidemenu.css" media="screen"/>

		<script type="text/javascript" src="cordova.js"></script>
		<script type="text/javascript" src="js/jquery-1.10.2.min.js"></script>
		<script type="text/javascript" src="js/custom.jquery.js"></script>
		<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,400italic,600,600italic,700,800,700italic"
			  rel="stylesheet" type="text/css"/>
	</head>
	<body id="slidemenu">
		<div id="holder-languages">
			<a href="#" class="language-flag english selected">&nbsp;</a>
			<a href="#" class="language-flag german">&nbsp;</a>
			<a href="#" class="language-flag dutch">&nbsp;</a>
			<a href="#" class="language-flag french">&nbsp;</a>
			<a href="#" class="language-flag spanish">&nbsp;</a>
		</div>
		<div id="holder-account-info">
			<h1><span class="autoupdate" data-term="firstname"></span>&nbsp;<span class="autoupdate" data-term="lastname"></span></h1>
			<ul class="actions">
				<li class="">
					<a href="#">
						<span class="actions-icon"><i class="fa fa-user fa-2x"></i></span>
						<span class="actions-descriptions autoupdate" data-term="username">&nbsp;</span>
					</a>
				</li>
				<li class="">
					<a href="#">
						<span class="actions-icon"><i class="fa fa-shopping-cart fa-2x"></i></span>
						<span class="actions-descriptions autoupdate" data-term="itemscount">&nbsp;</span>
					</a>
				</li>
			</ul>
		</div>
		<div id="holder-shopping-cart">
			<h2>Ordered items</h2>
			<ul id="shopping-cart">
				<li>
					<a href="#" class="row gutters">
						<span class="col span_4">Item</span>
						<span class="col span_20 item"><strong>Aldara 5% Cream x 12 Sachets</strong></span>
					</a>
					<a href="#" class="row gutters">
						<span class="col span_4">Item price</span>
						<span class="col span_20 itemprice">&pound; 1234.99</span>
					</a>
					<a href="#" class="row gutters">
						<span class="col span_4">Quantity</span>
						<span class="col span_20 quantity">&pound; 1234.99</span>
					</a>
					<a href="#" class="row gutters">
						<span class="col span_4">Subtotal</span>
						<span class="col span_20 subtotal">&pound; 3704.97</span>
					</a>
				</li>
				<li>
					<a href="#" class="row gutters">
						<span class="col span_4">Item</span>
						<span class="col span_20 item">Aldara 5% Cream x 12 Sachets</span>
					</a>
					<a href="#" class="row gutters">
						<span class="col span_4">Item price</span>
						<span class="col span_20 itemprice">&pound; 1234.99</span>
					</a>
					<a href="#" class="row gutters">
						<span class="col span_4">Quantity</span>
						<span class="col span_20 quantity">&pound; 1234.99</span>
					</a>
					<a href="#" class="row gutters">
						<span class="col span_4">Subtotal</span>
						<span class="col span_20 subtotal">&pound; 3704.97</span>
					</a>
				</li>
			</ul>

			<label>Temp</label>
			<textarea id="console" data-term="items" rows="10"></textarea>
			<button id="manually-pull">Manually pull userdata</button>
		</div>

		<script type="text/javascript">
			var oLocalStorage = new classLocalStorage();
			function PowerUp() {
				var oLocalStorage = new classLocalStorage();
				var $shoppingCart = $('#shopping-cart');

				function UpdateInfo() {
					$('.autoupdate').each(function() {
						var $this = $(this);
						//$('#' + this.id).hide().html(oLocalStorage[this.id]).show();
						
						$this.hide();
						if ($this.is('input') || $this.is('select') || $this.is('textarea')) {
							$this.val(oLocalStorage[$this.data('term')]);
						} else {
							$this.html(oLocalStorage[$this.data('term')]).show();
						}
						$this.show();
					})
				}
				
				$('#manually-pull').on('touchstart click', function(e) {
					e.preventDefault();
					oLocalStorage.IsLogged();
					//alert('slidemenu.html - oLocalStorage.logged: ' + oLocalStorage.logged);
					//alert(oLocalStorage.logged);
					if (oLocalStorage.logged == 1) {
						oLocalStorage.GetLoggedData();
						UpdateInfo();
						alert('oLocalStorage.username 1: ' + oLocalStorage.username);
						alert('oLocalStorage.itemscount 1: ' + oLocalStorage.itemscount);
						alert('oLocalStorage.firstname 1: ' + oLocalStorage.firstname);
						alert('oLocalStorage.lastname 1: ' + oLocalStorage.lastname);
						//alert('oLocalStorage.items 1: ' + oLocalStorage.items);
					} else {
						alert('No user data in local storage!');
					}
				});
			};
			
			$(function() {
				document.addEventListener("deviceready", PowerUp, true);
				document.addEventListener("LOGGEDIN", function(e) {
					oLocalStorage.IsLogged();
					alert('LOGGEDIN event fired, now lets start populate slidemenu');
					if (oLocalStorage.logged == 1) {
						oLocalStorage.GetLoggedData();
						UpdateInfo();
						//alert('oLocalStorage.username2: ' + oLocalStorage.username);
						//alert('oLocalStorage.itemscount 2: ' + oLocalStorage.itemscount);
						//alert('oLocalStorage.items 2: ' + oLocalStorage.items);
					} else {
						alert('Nu user data to get from local storage!');
					}
				});
				document.addEventListener("OPENCART", function(e) { 
					//alert('OPENCART event fired, opening slidemenu');
				});
			});
			var LOGGEDIN = document.createEvent('Event');
			var OPENCART = document.createEvent('Event');
			LOGGEDIN.initEvent('LOGGEDIN',true,true);
			OPENCART.initEvent('OPENCART',true,true);
		</script>
	</body>
</html>